import Head from 'next/head'
import axios from "axios";
import {useEffect, useState} from "react";


export default function SSG({data}) {
    const [list, setList] = useState([]);
    const [gender, setGender] = useState('all');

    useEffect(()=>{
        if(gender !== 'all'){
            const res = data.filter(row=>row.gender === gender)
            setList(res)
        }else {
            setList(data)
        }

    },[gender])

    return (
        <div>
            <Head>
                <title> Faheem</title>
                <meta name="description" content="Generated by create next app" />
                <link rel="icon" href="/favicon.ico" />
            </Head>
            <main>
                <h1>Address Book</h1>
                <h3>Hello Terry!</h3>
                <div onChange={(e)=>setGender(e.target.value)}>
                    <input type='radio' id={'male'} value={'male'} name={'gender'}/> Male
                    <input type='radio' id={'female'} value={'female'} name={'gender'}/> Female
                    <input type='radio' id={'all'} value={'all'} name={'gender'}/>All
                </div>
                <table>
                    <tr>
                        <th>Avatar</th>
                        <th>Name</th>
                        <th>Email</th>
                    </tr>
                    {list?.map((row , i)=>
                        <tr key={i}>
                            <td><img src={row.picture.thumbnail} alt={row.name?.first}/></td>
                            <td>{`${row.name?.title} ${row.name?.first} ${row.name?.last}  `}</td>
                            <td>{row.email}</td>
                        </tr>
                    )}
                </table>

            </main>

        </div>
    )
}
export async function getStaticProps(){
    const res = await axios.get('https://randomuser.me/api/?results=10');
    const data = await res.data?.results;
    const maleData = await data.filter(row => row.gender === 'male' )
    const femaleData = await data.filter(row => row.gender === 'female' )
    return{
        props:{
            data ,
            maleData,
            femaleData
        }
    }
}
